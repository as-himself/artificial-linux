# Artificial Linux - Kernel config fragment (BPF, BTF, LSM)
# Apply on top of kernel defconfig: scripts/kconfig/merge_config.sh -m .config kernel.config
# Or append to .config when building for LFS.

# eBPF and BPF LSM (required for AI fabric)
CONFIG_BPF=y
CONFIG_BPF_SYSCALL=y
CONFIG_BPF_JIT=y
CONFIG_HAVE_EBPF_JIT=y
CONFIG_DEBUG_INFO_BTF=y
CONFIG_BPF_LSM=y
CONFIG_LSM="landlock,lockdown,yama,integrity,bpf"
CONFIG_BPF_UNPRIV_DEFAULT_OFF=n

# Cgroups (required by systemd)
CONFIG_CGROUPS=y
CONFIG_MEMCG=y
CONFIG_CGROUP_CPUACCT=y
CONFIG_CGROUP_DEVICE=y
CONFIG_CGROUP_FREEZER=y
CONFIG_CGROUP_PIDS=y
CONFIG_CGROUP_SCHED=y

# Networking (for BPF and general use)
CONFIG_NET=y
CONFIG_NET_CLS_BPF=m
CONFIG_NET_ACT_BPF=m
CONFIG_BPF_STREAM_PARSER=y

# Optional: enable more for eBPF tooling
CONFIG_BPF_EVENTS=y
CONFIG_FTRACE_SYSCALLS=y
CONFIG_HAVE_DYNAMIC_FTRACE=y

# Live ISO: must be built-in so initramfs can mount squashfs without loading modules
CONFIG_BLK_DEV_LOOP=y
CONFIG_SQUASHFS=y
CONFIG_SQUASHFS_XZ=y
CONFIG_SQUASHFS_ZSTD=n
